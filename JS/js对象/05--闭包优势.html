<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>闭包</title>
</head>
<body>
<div id="1">1</div>
<div id="2">2</div>
<div id="3">3</div>
</body>
<script>
  /* 好处一:减少全局变量 */
  function f1() {
    var a = 0;
    return function () {
      a++;
      alert(a);
    }
  }
//  var result = f1();
//  result();
//  result();

  /* 好处二:减少参数传递 */
  function calFactory(base) {
    return function(max){
      var total = 0;
      for (var i=1;i<=max;i++){
        total+=i;
      }
      return total + base;
    }
  }
  var adder = calFactory(2);
//  alert(adder(4));

  /* 好初三:封装 */
  (function wrap() {
    var m = 0;
    function getM() {
      return m;
    }
    function setM(val) {
      m = val;
    }
    window.g = getM;
    window.s = setM;
  })();
  s(34);
//  alert(g());

  /* 注意点一:对捕获的变量只是引用,并不是赋值 */
  function f2() {
    var num = 2;
    function f22(){
      alert(num)
    }
    num++;
    f22();
  }
  //f2();// 3

  /* 注意点二: 父函数每调用一次就会产生一个不同的闭包 */
  function f3() {
    var num = 1;
    return function() {
      num++;
      alert(num);
    }
  }

  var r1 = f3();//第一次调用产生一个词法环境
  //r1();// 2
  //r1();// 3

  var r2 = f3();//第二次调用产生一个新的词法环境
  //r2();// 2
  //r2();// 3

  var j;
  for(j=1;j<=3;j++) {
    var ele = document.getElementById(j);
    ele.onclick = (function(id){
      return function(){
        alert(id)
      }
    })(j)
  }
</script>
</html>